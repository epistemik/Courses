% Mark Sattolo 428500
% TRC answers to assn1 for csi3317

% Provide complete details of all suppliers in London.
q1 := { S | supplier(S) and S.city = 'London' } ;

% Provide project names and cities.
q2 := { J.jname, J.city | projet(J) } ;

% Provide all cities in which a supplier or project (or both) are located.
q3a := { S.city, J.city | supplier(S) and projet(J) and ((exists T) (supplier(T) and S.city=T.city) or (exists K)(projet(K) and J.city=K.city)) } ;
q3b := { S.city | supplier(S) } ;
q3c := { J.city | projet(J) } ;
q3 := { Q.city | q3b(Q) or q3c(Q) } ;

% Provide supplier numbers for suppliers who supply part P1.
q4 := { R.snum | supplier_part_projet(R) and R.pnum = 'p1' } ;

% Provide project names which use red or green parts.
q5 := { J.jname | projet(J) and (exists R)(supplier_part_projet(R) and 
            (exists P)(part(P) and R.jnum = J.jnum and R.pnum = P.pnum and (P.color = 'Red' or P.color = 'Green' ) ) )  } ;

% Provide the part names used in a project with quantity equal to 500.
q6 := { P.pname | part(P) and (exists R)(supplier_part_projet(R) and R.pnum = P.pnum and R.qty = 500) } ;

% Provide all the cities in which suppliers are located, but no parts are located.
q7 := { S.city | supplier(S) and not (exists P) (part(P) and S.city = P.city) } ;

% Provide the supplier name/part name pairs for which the indicated supplier does not supply the indicated part.
q8 := { S.sname, J.jname | supplier(S) and projet(J) and (exists R)(supplier_part_projet(R) and S.snum = R.snum and J.jnum = R.jnum) } ;

% Provide the supplier name/part name pairs for which the indicated supplier does not supply the indicated part.
%XXXq9 := { S.sname, P.pname | supplier(S) and part(P) and not (exists R) (supplier_part_projet(R) and S.snum = R.snum and P.pnum = R.pnum) } ;
% >> DOESN'T ELIMINATE THE DUPLICATE "Jones, Screw"

q9s1 := { S.sname, P.pname | supplier(S) and part(P) } ;
q9s2 := { S.sname, P.pname | supplier(S) and part(P) and (exists R) (supplier_part_projet(R) and S.snum = R.snum and P.pnum = R.pnum) } ;
q9 := { Q.sname, Q.pname | q9s1(Q) and not (exists K)( q9s2(K) and Q.sname = K.sname and Q.pname = K.pname) } ;


% TUPLE RELATIONAL CALCULUS
% ----------------------------------------------

% ----- query 1 -----;
% Retrieve the name and address of all employees who work for the 'Research' department.

%  trc1 := { T.fname, T.lname, T.address | employee(T) and 
%                (exists D) (department (D) and D.dname='Research' and D.dnumber=T.dno) };

% ----- query 2 -----;
% For every project located in 'Stafford', list the project number, the controlling department number, 
% and the department manager's last name, address, and birthdate.

%  trc2 := { P.pnumber, P.dnum, M.lname, M.bdate, M.address | projects(P) and employee(M) and P.plocation='Stafford' and 
%                (exists D) (department(D) and P.dnum=D.dnumber and D.mgrssn=M.ssn) };

% ----- query 3 -----;
% Find the names of employees who work on all the projects controlled by department number 5.
% 'FORALL' REQUIRES THE FORM: (x)(Fx -> Gx)
% trc3 := { E.lname, E.fname | employee(E) and (forall X) (not (projects(X)) or 
%               (not (X.dnum=5) or (exists W) (works_on(W) and W.essn=E.ssn and X.pnumber=W.pno)))};

% ----- query 4 -----;
% Make a list of project numbers for projects that involve an employee whose last name is 'Smith', 
% either as a worker or as a manager of the department that controls the project.

% trc4 := { P.pnumber | projects(P) and ((exists E,W) (employee(E) and 
%               works_on(W) and W.pno=P.pnumber and E.lname='Smith' and E.ssn=W.essn)
%               or (exists M,D) (employee(M) and department(D) and P.dnum=D.dnumber and D.mgrssn=M.ssn and M.lname='Smith')) };

% ----- query 5 -----;
% List the names of all employees with two or more dependents.

% trc5 := { E.lname, E.fname | employee(E) and (exists D1,D2) (dependent(D1) and dependent(D2) and 
%               D1.essn=E.ssn and D2.essn=E.ssn and D1.dependent_name<>D2.dependent_name) };
