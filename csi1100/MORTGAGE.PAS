PROGRAM Mortgage(Input, Output);{ This program computes the monthly installments of a mortgage loan over a number of years.  Ph. Gabrini	November 1991 }   Var Loan, AnnualRate, MonthlyRate, Payment,    MonthlyInterest, Interests, Balance: REAL;    Years, Months: Integer;    Answer: CHAR;{******************************************************}PROCEDURE GetLoanData(Var Amount, InterestRate: REAL;                      Var Duration: Integer);{ Get loan amount (from 10,000 to 500,000), annual interest rate (from 3% to 20%), and loan  duration (from 1 year to 35 years) }Begin  Write('Amount of mortgage loan: ');  REPEAT    Readln(Amount); Writeln;    IF (Amount < 10000.0) OR (Amount > 500000.0) THEN      Write('Amount either too large or too small, please re-enter: ');  UNTIL (Amount >= 10000) AND (Amount <= 500000.0);  Write('Annual interest rate: ');  REPEAT    Readln(InterestRate); Writeln;    IF (InterestRate > 20.0) OR (InterestRate < 3.0) THEN      Write('Impossible rate, please reenter: ')  UNTIL (InterestRate >= 3.0) AND (InterestRate <= 20.0);  Write('Length of mortgage loan (in years): ');  REPEAT    Readln(Duration); Writeln;    IF (Duration <1) OR (Duration > 35) THEN      Write('Invalid length, please reenter: ')  UNTIL (Duration >= 1) AND (Duration <= 35);End; {GetLoanData}{******************************************************}FUNCTION Power(Number: REAL; Exponent: Integer): REAL;{ Compute Number to the Exponent power }Var Index: Integer;    Result: REAL;Begin  Result := 1.0;  FOR Index := 1 TO Exponent DO    Result := Result * Number;  Power := Result;End; {Power}{******************************************************}PROCEDURE ComputeMonthlyPayment(Amount, Rate: REAL; Length: Integer;						  Var Payment, MonthRate: REAL);{ Given an Amount, an annual interest Rate and a loan Length in  months compute the monthly interest rate and the monthly payment }Var Coefficient: REAL;Begin  MonthRate := EXP(LN(1.0 + 0.01 * Rate / 2.0) / 6.0) - 1.0;  Coefficient := Power(1.0 + MonthRate, Length);  Payment := MonthRate * Loan *  (Coefficient / (Coefficient - 1.0))End; {ComputeMonthlyPayment}{******************************************************}PROCEDURE ComputeCostOfLoan(Balance, MonthRate: REAL; Period: Integer;                            Var Interests: REAL; Report: BOOLEAN);{ Given a loan Balance, the monthly interest rate, the length of the loan in months,  compute the interests paid and generate a detailed report if requested. }Var Index: Integer;    MonthInterest, Reduction: REAL;Begin  IF Report THEN    Writeln('   Payment#   Interest     Capital',            '       Cum. Int.        Balance');  FOR Index := 1 TO Period DO Begin    MonthInterest := MonthRate * Balance;    Interests := Interests + MonthInterest;    Reduction := Payment - MonthInterest;    Balance := Balance - Reduction;    IF Balance < 0.0 THEN Balance := 0.0;    IF Report AND (Index <= 60) THEN      Writeln('     ', Index:3, MonthInterest:13:2,              Reduction:12:2,              Interests:15:2, Balance:15:2);    IF Index = 60 THEN Begin      Writeln('Interest paid in 5 years:    ', Interests:15:2);      Writeln('Balance after 5 years:       ', Balance:15:2);    End { IF }  End { FOR }End; {ComputeCostOfLoan}{******************************************************}Begin   { program }  REPEAT    GetLoanData(Loan, AnnualRate, Years);    Months := 12 * Years;    ComputeMonthlyPayment(Loan, AnnualRate, Months,                          Payment, MonthlyRate);    Writeln('Monthly payment: ', Payment:9:2);    Write('Do you want a detailed report? ');    Readln(Answer); Writeln;    Balance := Loan;    Interests := 0.0;    ComputeCostOfLoan(Balance, MonthlyRate, Months,                      Interests, Answer in ['y', 'Y']);    Writeln('Total cost of mortgage loan: ', Interests:15:2);    Writeln;    Write('Do you want another loan computation? ');    Readln(Answer); Writeln;  UNTIL Answer in ['n', 'N'];End.